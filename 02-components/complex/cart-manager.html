<div data-component="cart-manager"
     data-position="top-right"
     data-currency="USD">
  <style>
    [data-component="cart-manager"] {
      position: fixed;
      background: white;
      padding: var(--space-lg);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      min-width: 200px;
      z-index: 100;
    }
    
    /* Position variants */
    [data-component="cart-manager"][data-position="top-right"] {
      top: var(--space-lg);
      right: var(--space-lg);
    }
    
    [data-component="cart-manager"][data-position="top-left"] {
      top: var(--space-lg);
      left: var(--space-lg);
    }
    
    [data-component="cart-manager"][data-position="bottom-right"] {
      bottom: var(--space-lg);
      right: var(--space-lg);
    }
    
    [data-component="cart-manager"][data-position="bottom-left"] {
      bottom: var(--space-lg);
      left: var(--space-lg);
    }
    
    .cart__header {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      margin-bottom: var(--space-md);
      padding-bottom: var(--space-md);
      border-bottom: 1px solid var(--color-gray-200);
    }
    
    .cart__icon {
      width: 24px;
      height: 24px;
    }
    
    .cart__title {
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
      margin: 0;
    }
    
    .cart__count {
      margin-left: auto;
      background: var(--color-primary);
      color: white;
      padding: 2px 8px;
      border-radius: var(--radius-full);
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-bold);
    }
    
    .cart__items {
      max-height: 300px;
      overflow-y: auto;
      margin-bottom: var(--space-md);
    }
    
    .cart__item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-sm) 0;
      font-size: var(--font-size-sm);
    }
    
    .cart__item-name {
      flex: 1;
      margin-right: var(--space-sm);
    }
    
    .cart__item-price {
      font-weight: var(--font-weight-medium);
    }
    
    .cart__empty {
      text-align: center;
      color: var(--color-gray-500);
      padding: var(--space-lg) 0;
    }
    
    .cart__total {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: var(--space-md);
      border-top: 2px solid var(--color-gray-200);
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-bold);
    }
    
    .cart__actions {
      margin-top: var(--space-lg);
      display: flex;
      gap: var(--space-sm);
    }
    
    .cart__button {
      flex: 1;
      padding: var(--space-sm) var(--space-md);
      border: none;
      border-radius: var(--radius-base);
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      cursor: pointer;
      transition: all var(--duration-fast);
    }
    
    .cart__button--primary {
      background: var(--color-primary);
      color: white;
    }
    
    .cart__button--primary:hover {
      background: #0056b3;
    }
    
    .cart__button--secondary {
      background: var(--color-gray-200);
      color: var(--color-gray-700);
    }
    
    .cart__button--secondary:hover {
      background: var(--color-gray-300);
    }
  </style>
  
  <div class="cart__header">
    <svg class="cart__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17M17 13v5m0 0l-3-3m3 3l3-3"></path>
    </svg>
    <h3 class="cart__title">Cart</h3>
    <span class="cart__count">0</span>
  </div>
  
  <div class="cart__items">
    <div class="cart__empty">Your cart is empty</div>
  </div>
  
  <div class="cart__total">
    <span>Total:</span>
    <span class="cart__total-value">$0.00</span>
  </div>
  
  <div class="cart__actions">
    <button class="cart__button cart__button--secondary" data-action="clear">Clear</button>
    <button class="cart__button cart__button--primary" data-action="checkout">Checkout</button>
  </div>
  
  <script>
  CS.component('cart-manager', {
    init() {
      this.items = [];
      this.currency = this.config.currency || 'USD';
      
      // Elements
      this.countEl = this.$('.cart__count');
      this.itemsEl = this.$('.cart__items');
      this.totalEl = this.$('.cart__total-value');
      this.clearBtn = this.$('[data-action="clear"]');
      this.checkoutBtn = this.$('[data-action="checkout"]');
      
      // Actions
      this.clearBtn.onclick = () => this.clear();
      this.checkoutBtn.onclick = () => this.checkout();
      
      // Listen for cart events
      this.setupEventListeners();
      
      // Initial render
      this.render();
    },
    
    setupEventListeners() {
      // Listen for any component adding to cart
      CS.on('*:cart:add', (event) => {
        this.addItem(event.detail);
      });
      
      // Specific product-card events
      CS.on('product-card:cart:add', (event) => {
        this.addItem(event.detail);
      });
    },
    
    addItem(item) {
      // Check if item already exists
      const existing = this.items.find(i => i.id === item.id);
      
      if (existing) {
        existing.quantity = (existing.quantity || 1) + (item.quantity || 1);
      } else {
        this.items.push({
          ...item,
          quantity: item.quantity || 1
        });
      }
      
      this.render();
      this.emit('update', { items: this.items, total: this.getTotal() });
    },
    
    removeItem(id) {
      this.items = this.items.filter(item => item.id !== id);
      this.render();
      this.emit('update', { items: this.items, total: this.getTotal() });
    },
    
    clear() {
      if (this.items.length === 0) return;
      
      if (confirm('Clear all items from cart?')) {
        this.items = [];
        this.render();
        this.emit('clear');
      }
    },
    
    checkout() {
      if (this.items.length === 0) return;
      
      this.emit('checkout', {
        items: this.items,
        total: this.getTotal()
      });
    },
    
    getTotal() {
      return this.items.reduce((sum, item) => {
        return sum + (item.price * (item.quantity || 1));
      }, 0);
    },
    
    formatPrice(amount) {
      return new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: this.currency
      }).format(amount);
    },
    
    render() {
      // Update count
      this.countEl.textContent = this.items.reduce((sum, item) => sum + (item.quantity || 1), 0);
      
      // Update items list
      if (this.items.length === 0) {
        this.itemsEl.innerHTML = '<div class="cart__empty">Your cart is empty</div>';
      } else {
        this.itemsEl.innerHTML = this.items.map(item => `
          <div class="cart__item" data-id="${item.id}">
            <span class="cart__item-name">${item.name} ${item.quantity > 1 ? `(${item.quantity})` : ''}</span>
            <span class="cart__item-price">${this.formatPrice(item.price * item.quantity)}</span>
          </div>
        `).join('');
      }
      
      // Update total
      this.totalEl.textContent = this.formatPrice(this.getTotal());
      
      // Update button states
      this.clearBtn.disabled = this.items.length === 0;
      this.checkoutBtn.disabled = this.items.length === 0;
    }
  });
  </script>
</div>